<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Class imbalance in bankruptcy prediction tasks | Yi Hao Chan </title> <meta name="author" content="Yi Hao Chan"> <meta name="description" content="Are deep learning models able to perform better than Altman?"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://yihao001.github.io/projects/bc3409_bankrupt/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Yi Hao</span> Chan </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Class imbalance in bankruptcy prediction tasks</h1> <p class="post-description">Are deep learning models able to perform better than Altman?</p> </header> <article> <blockquote> <p>This was done as a group project for BC3409 in AY18/19</p> </blockquote> <h2 id="key-contributions">Key contributions</h2> <ul> <li>Demonstrated that LSTM and GRU can do better than Altman‚Äôs Z-score in predicting bankruptcy</li> <li>Proposed a technique to deal with the perennial problem of imbalanced classes in bankruptcy prediction tasks</li> </ul> <h2 id="existing-work">Existing work</h2> <p>The problem of bankruptcy prediction has been well studied, with several established approaches such as Altman Z-score (1968) and Ohlson O-score (1980).</p> <p>Altman Z-score is calculated as follows:</p> \[Z = 1.2 X_1 + 1.4 X_2 + 3.3 X_3 + 0.6 X_4 + 1 X_5\] <p>where</p> <ul> <li>X_1 = working capital / total assets,</li> <li>X_2 = retained earnings / total assets,</li> <li>X_3 = EBIT / total assets,</li> <li>X_4 = market cap / total liabilities,</li> <li>X_5 = sales / total assets.</li> </ul> <p>The coefficients vary depending on the dataset used. For the above example, it was based on 66 companies (mainly in the manufacturing industry) with assets &gt; $1 million (keep in mind that this was proposed in the 60s).</p> <p>In general, bankruptcy risk is higher if the z-score is low (&lt; 1.8). However, it‚Äôs more nuanced than a binary classification as a score above 3.0 suggests that bankruptcy is unlikely, while values between 1.8 and 3.0 are indeterminate.</p> <p>On the other hand, Ohlson O-score is more recent and used data from 2,000 companies. However, it requires information outside of financial reports, such as the Gross National Product. Thus, we focus on comparing against Altman Z-score.</p> <p>Would a deep learning model work better than such traditional approaches? Intuition suggests that it should (since they are quite dated), but let‚Äôs find out! üîç</p> <h2 id="methods">Methods</h2> <p>We obtained our dataset from the <a href="https://www.simfin.com/en/fundamental-data-download/" rel="external nofollow noopener" target="_blank">SimFin API</a>. This comprised fundamentals from 2165 companies listed in the US (2009 to 2019). Out of these companies, 44 went through Chapter 7 or 11 bankruptcies during this time period.</p> <p>Missing data limits the number of features we could use. This eventuated in 1362 companies being selected with complete data for the following 12 attributes:</p> <ol> <li>Equity / total assets</li> <li>(Total liabilities * 365) / (gross profit + depreciation)</li> <li>(Gross profit + depreciation) / total liabilities</li> <li>Total assets / total liabilities</li> <li>Total liabilities / total assets</li> <li>Log of total assets</li> <li>Working capital / total assets</li> <li>Total liabilities / ((profit on operating activities + depreciation) * (12/365))</li> <li>Current assets / total liabilities</li> <li>Working capital</li> <li>EBIT / total assets</li> <li>Book value of equity / total liabilities</li> </ol> <p>In terms of modelling, we used the original coefficients for Altman Z-score. For deep learning models, we experimented with a model architecture comprising 4 LSTM/GRU layers followed by a dense layer with sigmoid activation function to perform the classification.</p> <p>One key novelty is the approach used to address class imbalance. From preliminary explorations on the <a href="https://archive.ics.uci.edu/dataset/365/polish+companies+bankruptcy+data" rel="external nofollow noopener" target="_blank">Polish dataset</a>, we found that oversampling via SMOTE was not very effective. Thus, we created 2 sets of criteria as a proxy for bankruptcy:</p> <ol> <li>Equity: Equity &lt; 0, ROE &lt; -50%</li> <li>Debt: Solvency ratio &lt; 0.2, Debt-to-Equity ratio &gt; 2</li> </ol> <p>Companies that fulfill either of these criteria were labelled as bankrupt for the purpose of training the deep learning model. Using this approach, 445 companies were labelled as bankrupt, thus reducing the class imbalance.</p> <h2 id="results">Results</h2> <p>For Altman Z-score, only 31 companies had enough data to compute the score. On this subset, 20/31 were correctly classified as bankrupt, giving an accuracy of 64%. Notably, the Altman Z-score approach led to many false positives for the rest of the dataset (i.e. non-bankrupt companies), producing a precision of 0.03. On the other hand, the LSTM model was able to achieve an accuracy of 75% and the GRU model obtained an accuracy of 83%.</p> <h2 id="future-work">Future work</h2> <p>Although the deep learning model performed better, it would have been fairer to re-fit the model used by Altman on more recent data that is representative of our SimFin dataset.</p> <p>While classification accuracies seem quite high, it would have been more useful to predict bankruptcy before it happens, rather than our simplified approach of using data from the entire time series. The use of weak labels in our approach does help alleviate this issue, but it remains to be seen if the model could do better than such simple proxies in predicting future bankruptcies.</p> <h2 id="learning-points">Learning points</h2> <p>Class imbalance is a problem that plagues many tasks (e.g. prediction of rare events like diseases). While several standard measures are often proposed (e.g. over/undersampling, setting class weights to give more emphasis to the minority class), these could still fail in situations with extreme class imbalance. The use of proxies / weak labels presents a viable alternative to tackle this problem.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> ¬© Copyright 2024 Yi Hao Chan. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?601a2d3465e2a52bec38b600518d5f70"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-projects",title:"projects",description:"",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-teaching",title:"teaching",description:"",section:"Navigation",handler:()=>{window.location.href="/teaching/"}},{id:"post-evaluating-xai-algorithms",title:"Evaluating XAI algorithms",description:"Measuring robustness of explanations objectively",section:"Posts",handler:()=>{window.location.href="/blog/2024/reconfirm/"}},{id:"post-revamp",title:"Revamp",description:"refresh!",section:"Posts",handler:()=>{window.location.href="/blog/2024/revamp/"}},{id:"post-confusion-matrices-in-sklearn",title:"Confusion Matrices in sklearn",description:"confusion matrices are confusing",section:"Posts",handler:()=>{window.location.href="/blog/2020/confusion/"}},{id:"post-learning-machines",title:"Learning Machines",description:"beyond machine learning",section:"Posts",handler:()=>{window.location.href="/blog/2020/learning/"}},{id:"post-decomposing-huge-matrices",title:"Decomposing huge matrices",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2020/decompose/"}},{id:"post-repurposing-hard-disks",title:"Repurposing hard disks",description:"many parts of a crashed computer are still reusable",section:"Posts",handler:()=>{window.location.href="/blog/2019/repurpose/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"projects-class-imbalance-in-bankruptcy-prediction-tasks",title:"Class imbalance in bankruptcy prediction tasks",description:"Are deep learning models able to perform better than Altman?",section:"Projects",handler:()=>{window.location.href="/projects/bc3409_bankrupt/"}},{id:"projects-singlish-sentiment-analysis",title:"Singlish sentiment analysis",description:"Can BERT perform polarity detection on text with code-switching?",section:"Projects",handler:()=>{window.location.href="/projects/ce7455_singlish/"}},{id:"projects-licence-plate-recognition-with-motion-blur",title:"Licence plate recognition with motion blur",description:"Will CNNs still work well in such situations?",section:"Projects",handler:()=>{window.location.href="/projects/ureca_alpr/"}},{id:"teaching-cz2002-object-oriented-design-amp-programming",title:"CZ2002 Object Oriented Design & Programming",description:"AY20/21, Semester 1",section:"Teaching",handler:()=>{window.location.href="/teaching/AY2021-S1-CZ2002/"}},{id:"teaching-cx1115-introduction-to-ds-and-ai",title:"CX1115 Introduction to DS and AI",description:"AY20/21, Semester 2",section:"Teaching",handler:()=>{window.location.href="/teaching/AY2021-S2-CX1115/"}},{id:"teaching-cz4042-neural-networks-and-deep-learning",title:"CZ4042 Neural Networks and Deep Learning",description:"AY21/22, AY22/23, AY23/24",section:"Teaching",handler:()=>{window.location.href="/teaching/AY2122-S1-CZ4042/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%79%69%68%61%6F%30%31%39@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=68v21DIAAAAJ","_blank")}},{id:"socials-x",title:"X",description:"Twitter",section:"Socials",handler:()=>{window.open("https://twitter.com/randcogitation","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js"></script> </body> </html>